(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2pMplex = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Libp2pMplex=(()=>{var E=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var kt=E((Tn,k)=>{var Ot=(...r)=>{let t;for(;r.length;)t=r.shift()(t);return t},st=r=>r&&(typeof r[Symbol.asyncIterator]=="function"||typeof r[Symbol.iterator]=="function"||typeof r.next=="function"),Y=r=>r&&typeof r.sink=="function"&&st(r.source),nr=r=>t=>(r.sink(t),r.source),Nt=(...r)=>{if(Y(r[0])){let t=r[0];r[0]=()=>t.source}else if(st(r[0])){let t=r[0];r[0]=()=>t}if(r.length>1&&Y(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let t=1;t<r.length-1;t++)Y(r[t])&&(r[t]=nr(r[t]));return Ot(...r)};k.exports=Nt;k.exports.pipe=Nt;k.exports.rawPipe=Ot;k.exports.isIterable=st;k.exports.isDuplex=Y});var Dt=E((Mn,Pt)=>{Pt.exports=class{constructor(t){if(!(t>0)||(t-1&t)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){let t=this.buffer[this.btm];if(t!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}isEmpty(){return this.buffer[this.btm]===void 0}}});var Gt=E((On,qt)=>{var $t=Dt();qt.exports=class{constructor(t){this.hwm=t||16,this.head=new $t(this.hwm),this.tail=this.head}push(t){if(!this.head.push(t)){let e=this.head;this.head=e.next=new $t(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(t===void 0&&this.tail.next){let e=this.tail.next;return this.tail.next=null,this.tail=e,this.tail.shift()}return t}isEmpty(){return this.head.isEmpty()}}});var ft=E((Nn,zt)=>{var ut=Gt();zt.exports=r=>{r=r||{};let t;typeof r=="function"?(t=r,r={}):t=r.onEnd;let e=new ut,n,i,o,s=()=>{if(!e.isEmpty()){if(r.writev){let x,y=[];for(;!e.isEmpty();){if(x=e.shift(),x.error)throw x.error;y.push(x.value)}return{done:x.done,value:y}}let p=e.shift();if(p.error)throw p.error;return p}return o?{done:!0}:new Promise((p,x)=>{i=y=>(i=null,y.error?x(y.error):r.writev&&!y.done?p({done:y.done,value:[y.value]}):p(y),n)})},a=p=>i?i(p):(e.push(p),n),h=p=>(e=new ut,i?i({error:p}):(e.push({error:p}),n)),l=p=>o?n:a({done:!1,value:p}),f=p=>o?n:(o=!0,p?h(p):a({done:!0})),c=()=>(e=new ut,f(),{done:!0}),d=p=>(f(p),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:s,return:c,throw:d,push:l,end:f},!t)return n;let w=n;return n={[Symbol.asyncIterator](){return this},next(){return w.next()},throw(p){return w.throw(p),t&&(t(p),t=null),{done:!0}},return(){return w.return(),t&&(t(),t=null),{done:!0}},push:l,end(p){return w.end(p),t&&(t(p),t=null),n}},n}});var Wt=E((kn,jt)=>{var P=1e3,D=P*60,q=D*60,M=q*24,ir=M*7,or=M*365.25;jt.exports=function(r,t){t=t||{};var e=typeof r;if(e==="string"&&r.length>0)return sr(r);if(e==="number"&&isFinite(r))return t.long?fr(r):ur(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function sr(r){if(r=String(r),!(r.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!t){var e=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return e*or;case"weeks":case"week":case"w":return e*ir;case"days":case"day":case"d":return e*M;case"hours":case"hour":case"hrs":case"hr":case"h":return e*q;case"minutes":case"minute":case"mins":case"min":case"m":return e*D;case"seconds":case"second":case"secs":case"sec":case"s":return e*P;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e;default:return}}}}function ur(r){var t=Math.abs(r);return t>=M?Math.round(r/M)+"d":t>=q?Math.round(r/q)+"h":t>=D?Math.round(r/D)+"m":t>=P?Math.round(r/P)+"s":r+"ms"}function fr(r){var t=Math.abs(r);return t>=M?Z(r,t,M,"day"):t>=q?Z(r,t,q,"hour"):t>=D?Z(r,t,D,"minute"):t>=P?Z(r,t,P,"second"):r+" ms"}function Z(r,t,e,n){var i=t>=e*1.5;return Math.round(r/e)+" "+n+(i?"s":"")}});var Xt=E((Pn,Vt)=>{function cr(r){e.debug=e,e.default=e,e.coerce=h,e.disable=o,e.enable=i,e.enabled=s,e.humanize=Wt(),e.destroy=l,Object.keys(r).forEach(f=>{e[f]=r[f]}),e.names=[],e.skips=[],e.formatters={};function t(f){let c=0;for(let d=0;d<f.length;d++)c=(c<<5)-c+f.charCodeAt(d),c|=0;return e.colors[Math.abs(c)%e.colors.length]}e.selectColor=t;function e(f){let c,d=null;function w(...p){if(!w.enabled)return;let x=w,y=Number(new Date),b=y-(c||y);x.diff=b,x.prev=c,x.curr=y,c=y,p[0]=e.coerce(p[0]),typeof p[0]!="string"&&p.unshift("%O");let H=0;p[0]=p[0].replace(/%([a-zA-Z%])/g,(ot,er)=>{if(ot==="%%")return"%";H++;let Lt=e.formatters[er];if(typeof Lt=="function"){let rr=p[H];ot=Lt.call(x,rr),p.splice(H,1),H--}return ot}),e.formatArgs.call(x,p),(x.log||e.log).apply(x,p)}return w.namespace=f,w.useColors=e.useColors(),w.color=e.selectColor(f),w.extend=n,w.destroy=e.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>d===null?e.enabled(f):d,set:p=>{d=p}}),typeof e.init=="function"&&e.init(w),w}function n(f,c){let d=e(this.namespace+(typeof c=="undefined"?":":c)+f);return d.log=this.log,d}function i(f){e.save(f),e.names=[],e.skips=[];let c,d=(typeof f=="string"?f:"").split(/[\s,]+/),w=d.length;for(c=0;c<w;c++)!d[c]||(f=d[c].replace(/\*/g,".*?"),f[0]==="-"?e.skips.push(new RegExp("^"+f.substr(1)+"$")):e.names.push(new RegExp("^"+f+"$")))}function o(){let f=[...e.names.map(a),...e.skips.map(a).map(c=>"-"+c)].join(",");return e.enable(""),f}function s(f){if(f[f.length-1]==="*")return!0;let c,d;for(c=0,d=e.skips.length;c<d;c++)if(e.skips[c].test(f))return!1;for(c=0,d=e.names.length;c<d;c++)if(e.names[c].test(f))return!0;return!1}function a(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function h(f){return f instanceof Error?f.stack||f.message:f}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return e.enable(e.load()),e}Vt.exports=cr});var ct=E((I,J)=>{I.formatArgs=hr;I.save=ar;I.load=lr;I.useColors=pr;I.storage=dr();I.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();I.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function pr(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function hr(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+J.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;r.splice(1,0,t,"color: inherit");let e=0,n=0;r[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(e++,i==="%c"&&(n=e))}),r.splice(n,0,t)}I.log=console.debug||console.log||(()=>{});function ar(r){try{r?I.storage.setItem("debug",r):I.storage.removeItem("debug")}catch(t){}}function lr(){let r;try{r=I.storage.getItem("debug")}catch(t){}return!r&&typeof process!="undefined"&&"env"in process&&(r=process.env.DEBUG),r}function dr(){try{return localStorage}catch(r){}}J.exports=Xt()(I);var{formatters:yr}=J.exports;yr.j=function(r){try{return JSON.stringify(r)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var Ht=E((Dn,vt)=>{vt.exports=function(t){if(t){if(typeof t[Symbol.iterator]=="function")return t[Symbol.iterator]();if(typeof t[Symbol.asyncIterator]=="function")return t[Symbol.asyncIterator]();if(typeof t.next=="function")return t}throw new Error("argument is not an iterator or iterable")}});var Zt=E(($n,Yt)=>{Yt.exports=class extends Error{constructor(t,e){super(t||"The operation was aborted");this.type="aborted",this.code=e||"ABORT_ERR"}}});var lt=E((Gn,L)=>{var wr=Ht(),ht=Zt(),Jt=(r,t,e)=>at(r,Array.isArray(t)?t:[{signal:t,options:e}]),at=(r,t)=>{r=wr(r),t=t.map(({signal:n,options:i})=>({signal:n,options:i||{}}));async function*e(){let n,i=()=>{n&&n()};for(let{signal:o}of t)o.addEventListener("abort",i);for(;;){let o;try{for(let{signal:a,options:h}of t)if(a.aborted){let{abortMessage:l,abortCode:f}=h;throw new ht(l,f)}let s=new Promise((a,h)=>{n=()=>{let{options:l}=t.find(({signal:d})=>d.aborted),{abortMessage:f,abortCode:c}=l;h(new ht(f,c))}});o=await Promise.race([s,r.next()]),n=null}catch(s){for(let{signal:l}of t)l.removeEventListener("abort",i);let a=t.find(({signal:l})=>l.aborted),h=s.type==="aborted"&&a;if(h&&a.options.onAbort&&await a.options.onAbort(r),typeof r.return=="function"&&await r.return(),h&&a.options.returnOnAbort)return;throw s}if(o.done)break;yield o.value}for(let{signal:o}of t)o.removeEventListener("abort",i)}return e()},Qt=(r,t,e)=>Kt(r,Array.isArray(t)?t:[{signal:t,options:e}]),Kt=(r,t)=>e=>r(at(e,t)),gr=(r,t,e)=>Er(r,Array.isArray(t)?t:[{signal:t,options:e}]),Er=(r,t)=>({sink:Kt(r.sink,t),source:at(r.source,t)});L.exports=Jt;L.exports.AbortError=ht;L.exports.source=Jt;L.exports.sink=Qt;L.exports.transform=Qt;L.exports.duplex=gr});var re=E((zn,te)=>{te.exports=pt;var ee=128,xr=127,mr=~xr,br=Math.pow(2,31);function pt(r,t,e){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw pt.bytes=0,new RangeError("Could not encode varint");t=t||[],e=e||0;for(var n=e;r>=br;)t[e++]=r&255|ee,r/=128;for(;r&mr;)t[e++]=r&255|ee,r>>>=7;return t[e]=r|0,pt.bytes=e-n+1,t}});var oe=E((jn,ne)=>{ne.exports=dt;var Br=128,ie=127;function dt(r,t){var e=0,t=t||0,n=0,i=t,o,s=r.length;do{if(i>=s||n>49)throw dt.bytes=0,new RangeError("Could not decode varint");o=r[i++],e+=n<28?(o&ie)<<n:(o&ie)*Math.pow(2,n),n+=7}while(o>=Br);return dt.bytes=i-t,e}});var ue=E((Wn,se)=>{var Ir=Math.pow(2,7),Fr=Math.pow(2,14),Cr=Math.pow(2,21),_r=Math.pow(2,28),Ar=Math.pow(2,35),Sr=Math.pow(2,42),Rr=Math.pow(2,49),Tr=Math.pow(2,56),Ur=Math.pow(2,63);se.exports=function(r){return r<Ir?1:r<Fr?2:r<Cr?3:r<_r?4:r<Ar?5:r<Sr?6:r<Rr?7:r<Tr?8:r<Ur?9:10}});var yt=E((Vn,fe)=>{fe.exports={encode:re(),decode:oe(),encodingLength:ue()}});var he=E(K=>{"use strict";K.byteLength=Mr;K.toByteArray=Lr;K.fromByteArray=Or;var _=[],F=[],Nr=typeof Uint8Array!="undefined"?Uint8Array:Array,wt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var $=0,kr=wt.length;$<kr;++$)_[$]=wt[$],F[wt.charCodeAt($)]=$;F["-".charCodeAt(0)]=62;F["_".charCodeAt(0)]=63;function ce(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");e===-1&&(e=t);var n=e===t?0:4-e%4;return[e,n]}function Mr(r){var t=ce(r),e=t[0],n=t[1];return(e+n)*3/4-n}function Pr(r,t,e){return(t+e)*3/4-e}function Lr(r){var t,e=ce(r),n=e[0],i=e[1],o=new Nr(Pr(r,n,i)),s=0,a=i>0?n-4:n,h;for(h=0;h<a;h+=4)t=F[r.charCodeAt(h)]<<18|F[r.charCodeAt(h+1)]<<12|F[r.charCodeAt(h+2)]<<6|F[r.charCodeAt(h+3)],o[s++]=t>>16&255,o[s++]=t>>8&255,o[s++]=t&255;return i===2&&(t=F[r.charCodeAt(h)]<<2|F[r.charCodeAt(h+1)]>>4,o[s++]=t&255),i===1&&(t=F[r.charCodeAt(h)]<<10|F[r.charCodeAt(h+1)]<<4|F[r.charCodeAt(h+2)]>>2,o[s++]=t>>8&255,o[s++]=t&255),o}function Dr(r){return _[r>>18&63]+_[r>>12&63]+_[r>>6&63]+_[r&63]}function qr(r,t,e){for(var n,i=[],o=t;o<e;o+=3)n=(r[o]<<16&16711680)+(r[o+1]<<8&65280)+(r[o+2]&255),i.push(Dr(n));return i.join("")}function Or(r){for(var t,e=r.length,n=e%3,i=[],o=16383,s=0,a=e-n;s<a;s+=o)i.push(qr(r,s,s+o>a?a:s+o));return n===1?(t=r[e-1],i.push(_[t>>2]+_[t<<4&63]+"==")):n===2&&(t=(r[e-2]<<8)+r[e-1],i.push(_[t>>10]+_[t>>4&63]+_[t<<2&63]+"=")),i.join("")}});var ae=E(Et=>{Et.read=function(r,t,e,n,i){var o,s,a=i*8-n-1,h=(1<<a)-1,l=h>>1,f=-7,c=e?i-1:0,d=e?-1:1,w=r[t+c];for(c+=d,o=w&(1<<-f)-1,w>>=-f,f+=a;f>0;o=o*256+r[t+c],c+=d,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=n;f>0;s=s*256+r[t+c],c+=d,f-=8);if(o===0)o=1-l;else{if(o===h)return s?NaN:(w?-1:1)*Infinity;s=s+Math.pow(2,n),o=o-l}return(w?-1:1)*s*Math.pow(2,o-n)};Et.write=function(r,t,e,n,i,o){var s,a,h,l=o*8-i-1,f=(1<<l)-1,c=f>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:o-1,p=n?1:-1,x=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===Infinity?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-s))<1&&(s--,h*=2),s+c>=1?t+=d/h:t+=d*Math.pow(2,1-c),t*h>=2&&(s++,h/=2),s+c>=f?(a=0,s=f):s+c>=1?(a=(t*h-1)*Math.pow(2,i),s=s+c):(a=t*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;r[e+w]=a&255,w+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;r[e+w]=s&255,w+=p,s/=256,l-=8);r[e+w-p]|=x*128}});var Se=E(G=>{"use strict";var gt=he(),z=ae(),le=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;G.Buffer=u;G.SlowBuffer=$r;G.INSPECT_MAX_BYTES=50;var Q=2147483647;G.kMaxLength=Q;u.TYPED_ARRAY_SUPPORT=Gr();!u.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function Gr(){try{let r=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(r,t),r.foo()===42}catch(r){return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(!!u.isBuffer(this))return this.buffer}});Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(!!u.isBuffer(this))return this.byteOffset}});function S(r){if(r>Q)throw new RangeError('The value "'+r+'" is invalid for option "size"');let t=new Uint8Array(r);return Object.setPrototypeOf(t,u.prototype),t}function u(r,t,e){if(typeof r=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return xt(r)}return pe(r,t,e)}u.poolSize=8192;function pe(r,t,e){if(typeof r=="string")return zr(r,t);if(ArrayBuffer.isView(r))return jr(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(A(r,ArrayBuffer)||r&&A(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(A(r,SharedArrayBuffer)||r&&A(r.buffer,SharedArrayBuffer)))return mt(r,t,e);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=r.valueOf&&r.valueOf();if(n!=null&&n!==r)return u.from(n,t,e);let i=Wr(r);if(i)return i;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return u.from(r[Symbol.toPrimitive]("string"),t,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}u.from=function(r,t,e){return pe(r,t,e)};Object.setPrototypeOf(u.prototype,Uint8Array.prototype);Object.setPrototypeOf(u,Uint8Array);function de(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function Vr(r,t,e){return de(r),r<=0?S(r):t!==void 0?typeof e=="string"?S(r).fill(t,e):S(r).fill(t):S(r)}u.alloc=function(r,t,e){return Vr(r,t,e)};function xt(r){return de(r),S(r<0?0:bt(r)|0)}u.allocUnsafe=function(r){return xt(r)};u.allocUnsafeSlow=function(r){return xt(r)};function zr(r,t){if((typeof t!="string"||t==="")&&(t="utf8"),!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);let e=ye(r,t)|0,n=S(e),i=n.write(r,t);return i!==e&&(n=n.slice(0,i)),n}function Bt(r){let t=r.length<0?0:bt(r.length)|0,e=S(t);for(let n=0;n<t;n+=1)e[n]=r[n]&255;return e}function jr(r){if(A(r,Uint8Array)){let t=new Uint8Array(r);return mt(t.buffer,t.byteOffset,t.byteLength)}return Bt(r)}function mt(r,t,e){if(t<0||r.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<t+(e||0))throw new RangeError('"length" is outside of buffer bounds');let n;return t===void 0&&e===void 0?n=new Uint8Array(r):e===void 0?n=new Uint8Array(r,t):n=new Uint8Array(r,t,e),Object.setPrototypeOf(n,u.prototype),n}function Wr(r){if(u.isBuffer(r)){let t=bt(r.length)|0,e=S(t);return e.length===0||r.copy(e,0,0,t),e}if(r.length!==void 0)return typeof r.length!="number"||It(r.length)?S(0):Bt(r);if(r.type==="Buffer"&&Array.isArray(r.data))return Bt(r.data)}function bt(r){if(r>=Q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Q.toString(16)+" bytes");return r|0}function $r(r){return+r!=r&&(r=0),u.alloc(+r)}u.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==u.prototype};u.compare=function(t,e){if(A(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),A(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,i=e.length;for(let o=0,s=Math.min(n,i);o<s;++o)if(t[o]!==e[o]){n=t[o],i=e[o];break}return n<i?-1:i<n?1:0};u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};u.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return u.alloc(0);let n;if(e===void 0)for(e=0,n=0;n<t.length;++n)e+=t[n].length;let i=u.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){let s=t[n];if(A(s,Uint8Array))o+s.length>i.length?(u.isBuffer(s)||(s=u.from(s)),s.copy(i,o)):Uint8Array.prototype.set.call(i,s,o);else if(u.isBuffer(s))s.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return i};function ye(r,t){if(u.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||A(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let e=r.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&e===0)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return Ft(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return we(r).length;default:if(i)return n?-1:Ft(r).length;t=(""+t).toLowerCase(),i=!0}}u.byteLength=ye;function Jr(r,t,e){let n=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,t>>>=0,e<=t))return"";for(r||(r="utf8");;)switch(r){case"hex":return Yr(this,t,e);case"utf8":case"utf-8":return Ee(this,t,e);case"ascii":return vr(this,t,e);case"latin1":case"binary":return Hr(this,t,e);case"base64":return Xr(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Zr(this,t,e);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}u.prototype._isBuffer=!0;function O(r,t,e){let n=r[t];r[t]=r[e],r[e]=n}u.prototype.swap16=function(){let t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)O(this,e,e+1);return this};u.prototype.swap32=function(){let t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)O(this,e,e+3),O(this,e+1,e+2);return this};u.prototype.swap64=function(){let t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)O(this,e,e+7),O(this,e+1,e+6),O(this,e+2,e+5),O(this,e+3,e+4);return this};u.prototype.toString=function(){let t=this.length;return t===0?"":arguments.length===0?Ee(this,0,t):Jr.apply(this,arguments)};u.prototype.toLocaleString=u.prototype.toString;u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:u.compare(this,t)===0};u.prototype.inspect=function(){let t="",e=G.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"};le&&(u.prototype[le]=u.prototype.inspect);u.prototype.compare=function(t,e,n,i,o){if(A(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(e===void 0&&(e=0),n===void 0&&(n=t?t.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),e<0||n>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&e>=n)return 0;if(i>=o)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,i>>>=0,o>>>=0,this===t)return 0;let s=o-i,a=n-e,h=Math.min(s,a),l=this.slice(i,o),f=t.slice(e,n);for(let c=0;c<h;++c)if(l[c]!==f[c]){s=l[c],a=f[c];break}return s<a?-1:a<s?1:0};function xe(r,t,e,n,i){if(r.length===0)return-1;if(typeof e=="string"?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,It(e)&&(e=i?0:r.length-1),e<0&&(e=r.length+e),e>=r.length){if(i)return-1;e=r.length-1}else if(e<0)if(i)e=0;else return-1;if(typeof t=="string"&&(t=u.from(t,n)),u.isBuffer(t))return t.length===0?-1:ge(r,t,e,n,i);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,t,e):Uint8Array.prototype.lastIndexOf.call(r,t,e):ge(r,[t],e,n,i);throw new TypeError("val must be string, number or Buffer")}function ge(r,t,e,n,i){let o=1,s=r.length,a=t.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||t.length<2)return-1;o=2,s/=2,a/=2,e/=2}function h(f,c){return o===1?f[c]:f.readUInt16BE(c*o)}let l;if(i){let f=-1;for(l=e;l<s;l++)if(h(r,l)===h(t,f===-1?0:l-f)){if(f===-1&&(f=l),l-f+1===a)return f*o}else f!==-1&&(l-=l-f),f=-1}else for(e+a>s&&(e=s-a),l=e;l>=0;l--){let f=!0;for(let c=0;c<a;c++)if(h(r,l+c)!==h(t,c)){f=!1;break}if(f)return l}return-1}u.prototype.includes=function(t,e,n){return this.indexOf(t,e,n)!==-1};u.prototype.indexOf=function(t,e,n){return xe(this,t,e,n,!0)};u.prototype.lastIndexOf=function(t,e,n){return xe(this,t,e,n,!1)};function Kr(r,t,e,n){e=Number(e)||0;let i=r.length-e;n?(n=Number(n),n>i&&(n=i)):n=i;let o=t.length;n>o/2&&(n=o/2);let s;for(s=0;s<n;++s){let a=parseInt(t.substr(s*2,2),16);if(It(a))return s;r[e+s]=a}return s}function Qr(r,t,e,n){return tt(Ft(t,r.length-e),r,e,n)}function en(r,t,e,n){return tt(tn(t),r,e,n)}function rn(r,t,e,n){return tt(we(t),r,e,n)}function on(r,t,e,n){return tt(nn(t,r.length-e),r,e,n)}u.prototype.write=function(t,e,n,i){if(e===void 0)i="utf8",n=this.length,e=0;else if(n===void 0&&typeof e=="string")i=e,n=this.length,e=0;else if(isFinite(e))e=e>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-e;if((n===void 0||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return Kr(this,t,e,n);case"utf8":case"utf-8":return Qr(this,t,e,n);case"ascii":case"latin1":case"binary":return en(this,t,e,n);case"base64":return rn(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return on(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Xr(r,t,e){return t===0&&e===r.length?gt.fromByteArray(r):gt.fromByteArray(r.slice(t,e))}function Ee(r,t,e){e=Math.min(r.length,e);let n=[],i=t;for(;i<e;){let o=r[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=e){let h,l,f,c;switch(a){case 1:o<128&&(s=o);break;case 2:h=r[i+1],(h&192)==128&&(c=(o&31)<<6|h&63,c>127&&(s=c));break;case 3:h=r[i+1],l=r[i+2],(h&192)==128&&(l&192)==128&&(c=(o&15)<<12|(h&63)<<6|l&63,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:h=r[i+1],l=r[i+2],f=r[i+3],(h&192)==128&&(l&192)==128&&(f&192)==128&&(c=(o&15)<<18|(h&63)<<12|(l&63)<<6|f&63,c>65535&&c<1114112&&(s=c))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=a}return sn(n)}var me=4096;function sn(r){let t=r.length;if(t<=me)return String.fromCharCode.apply(String,r);let e="",n=0;for(;n<t;)e+=String.fromCharCode.apply(String,r.slice(n,n+=me));return e}function vr(r,t,e){let n="";e=Math.min(r.length,e);for(let i=t;i<e;++i)n+=String.fromCharCode(r[i]&127);return n}function Hr(r,t,e){let n="";e=Math.min(r.length,e);for(let i=t;i<e;++i)n+=String.fromCharCode(r[i]);return n}function Yr(r,t,e){let n=r.length;(!t||t<0)&&(t=0),(!e||e<0||e>n)&&(e=n);let i="";for(let o=t;o<e;++o)i+=un[r[o]];return i}function Zr(r,t,e){let n=r.slice(t,e),i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}u.prototype.slice=function(t,e){let n=this.length;t=~~t,e=e===void 0?n:~~e,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<t&&(e=t);let i=this.subarray(t,e);return Object.setPrototypeOf(i,u.prototype),i};function m(r,t,e){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+t>e)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(t,e,n){t=t>>>0,e=e>>>0,n||m(t,e,this.length);let i=this[t],o=1,s=0;for(;++s<e&&(o*=256);)i+=this[t+s]*o;return i};u.prototype.readUintBE=u.prototype.readUIntBE=function(t,e,n){t=t>>>0,e=e>>>0,n||m(t,e,this.length);let i=this[t+--e],o=1;for(;e>0&&(o*=256);)i+=this[t+--e]*o;return i};u.prototype.readUint8=u.prototype.readUInt8=function(t,e){return t=t>>>0,e||m(t,1,this.length),this[t]};u.prototype.readUint16LE=u.prototype.readUInt16LE=function(t,e){return t=t>>>0,e||m(t,2,this.length),this[t]|this[t+1]<<8};u.prototype.readUint16BE=u.prototype.readUInt16BE=function(t,e){return t=t>>>0,e||m(t,2,this.length),this[t]<<8|this[t+1]};u.prototype.readUint32LE=u.prototype.readUInt32LE=function(t,e){return t=t>>>0,e||m(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};u.prototype.readUint32BE=u.prototype.readUInt32BE=function(t,e){return t=t>>>0,e||m(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};u.prototype.readBigUInt64LE=U(function(t){t=t>>>0,j(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&V(t,this.length-8);let i=e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24,o=this[++t]+this[++t]*2**8+this[++t]*2**16+n*2**24;return BigInt(i)+(BigInt(o)<<BigInt(32))});u.prototype.readBigUInt64BE=U(function(t){t=t>>>0,j(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&V(t,this.length-8);let i=e*2**24+this[++t]*2**16+this[++t]*2**8+this[++t],o=this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(o)});u.prototype.readIntLE=function(t,e,n){t=t>>>0,e=e>>>0,n||m(t,e,this.length);let i=this[t],o=1,s=0;for(;++s<e&&(o*=256);)i+=this[t+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i};u.prototype.readIntBE=function(t,e,n){t=t>>>0,e=e>>>0,n||m(t,e,this.length);let i=e,o=1,s=this[t+--i];for(;i>0&&(o*=256);)s+=this[t+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*e)),s};u.prototype.readInt8=function(t,e){return t=t>>>0,e||m(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]};u.prototype.readInt16LE=function(t,e){t=t>>>0,e||m(t,2,this.length);let n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};u.prototype.readInt16BE=function(t,e){t=t>>>0,e||m(t,2,this.length);let n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};u.prototype.readInt32LE=function(t,e){return t=t>>>0,e||m(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};u.prototype.readInt32BE=function(t,e){return t=t>>>0,e||m(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};u.prototype.readBigInt64LE=U(function(t){t=t>>>0,j(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&V(t,this.length-8);let i=this[t+4]+this[t+5]*2**8+this[t+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24)});u.prototype.readBigInt64BE=U(function(t){t=t>>>0,j(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&V(t,this.length-8);let i=(e<<24)+this[++t]*2**16+this[++t]*2**8+this[++t];return(BigInt(i)<<BigInt(32))+BigInt(this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n)});u.prototype.readFloatLE=function(t,e){return t=t>>>0,e||m(t,4,this.length),z.read(this,t,!0,23,4)};u.prototype.readFloatBE=function(t,e){return t=t>>>0,e||m(t,4,this.length),z.read(this,t,!1,23,4)};u.prototype.readDoubleLE=function(t,e){return t=t>>>0,e||m(t,8,this.length),z.read(this,t,!0,52,8)};u.prototype.readDoubleBE=function(t,e){return t=t>>>0,e||m(t,8,this.length),z.read(this,t,!1,52,8)};function B(r,t,e,n,i,o){if(!u.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(e+n>r.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(t,e,n,i){if(t=+t,e=e>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;B(this,t,e,n,a,0)}let o=1,s=0;for(this[e]=t&255;++s<n&&(o*=256);)this[e+s]=t/o&255;return e+n};u.prototype.writeUintBE=u.prototype.writeUIntBE=function(t,e,n,i){if(t=+t,e=e>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;B(this,t,e,n,a,0)}let o=n-1,s=1;for(this[e+o]=t&255;--o>=0&&(s*=256);)this[e+o]=t/s&255;return e+n};u.prototype.writeUint8=u.prototype.writeUInt8=function(t,e,n){return t=+t,e=e>>>0,n||B(this,t,e,1,255,0),this[e]=t&255,e+1};u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e=e>>>0,n||B(this,t,e,2,65535,0),this[e]=t&255,this[e+1]=t>>>8,e+2};u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e=e>>>0,n||B(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=t&255,e+2};u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e=e>>>0,n||B(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255,e+4};u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e=e>>>0,n||B(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};function Be(r,t,e,n,i){be(t,n,i,r,e,7);let o=Number(t&BigInt(4294967295));r[e++]=o,o=o>>8,r[e++]=o,o=o>>8,r[e++]=o,o=o>>8,r[e++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return r[e++]=s,s=s>>8,r[e++]=s,s=s>>8,r[e++]=s,s=s>>8,r[e++]=s,e}function Ie(r,t,e,n,i){be(t,n,i,r,e,7);let o=Number(t&BigInt(4294967295));r[e+7]=o,o=o>>8,r[e+6]=o,o=o>>8,r[e+5]=o,o=o>>8,r[e+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return r[e+3]=s,s=s>>8,r[e+2]=s,s=s>>8,r[e+1]=s,s=s>>8,r[e]=s,e+8}u.prototype.writeBigUInt64LE=U(function(t,e=0){return Be(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))});u.prototype.writeBigUInt64BE=U(function(t,e=0){return Ie(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))});u.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e=e>>>0,!i){let h=Math.pow(2,8*n-1);B(this,t,e,n,h-1,-h)}let o=0,s=1,a=0;for(this[e]=t&255;++o<n&&(s*=256);)t<0&&a===0&&this[e+o-1]!==0&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n};u.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e=e>>>0,!i){let h=Math.pow(2,8*n-1);B(this,t,e,n,h-1,-h)}let o=n-1,s=1,a=0;for(this[e+o]=t&255;--o>=0&&(s*=256);)t<0&&a===0&&this[e+o+1]!==0&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n};u.prototype.writeInt8=function(t,e,n){return t=+t,e=e>>>0,n||B(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=t&255,e+1};u.prototype.writeInt16LE=function(t,e,n){return t=+t,e=e>>>0,n||B(this,t,e,2,32767,-32768),this[e]=t&255,this[e+1]=t>>>8,e+2};u.prototype.writeInt16BE=function(t,e,n){return t=+t,e=e>>>0,n||B(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=t&255,e+2};u.prototype.writeInt32LE=function(t,e,n){return t=+t,e=e>>>0,n||B(this,t,e,4,2147483647,-2147483648),this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4};u.prototype.writeInt32BE=function(t,e,n){return t=+t,e=e>>>0,n||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};u.prototype.writeBigInt64LE=U(function(t,e=0){return Be(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});u.prototype.writeBigInt64BE=U(function(t,e=0){return Ie(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Fe(r,t,e,n,i,o){if(e+n>r.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function Ce(r,t,e,n,i){return t=+t,e=e>>>0,i||Fe(r,t,e,4,34028234663852886e22,-34028234663852886e22),z.write(r,t,e,n,23,4),e+4}u.prototype.writeFloatLE=function(t,e,n){return Ce(this,t,e,!0,n)};u.prototype.writeFloatBE=function(t,e,n){return Ce(this,t,e,!1,n)};function _e(r,t,e,n,i){return t=+t,e=e>>>0,i||Fe(r,t,e,8,17976931348623157e292,-17976931348623157e292),z.write(r,t,e,n,52,8),e+8}u.prototype.writeDoubleLE=function(t,e,n){return _e(this,t,e,!0,n)};u.prototype.writeDoubleBE=function(t,e,n){return _e(this,t,e,!1,n)};u.prototype.copy=function(t,e,n,i){if(!u.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);let o=i-n;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(e,n,i):Uint8Array.prototype.set.call(t,this.subarray(n,i),e),o};u.prototype.fill=function(t,e,n,i){if(typeof t=="string"){if(typeof e=="string"?(i=e,e=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!u.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(t.length===1){let s=t.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(t=s)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e=e>>>0,n=n===void 0?this.length:n>>>0,t||(t=0);let o;if(typeof t=="number")for(o=e;o<n;++o)this[o]=t;else{let s=u.isBuffer(t)?t:u.from(t,i),a=s.length;if(a===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var W={};function Ct(r,t,e){W[r]=class extends e{constructor(){super();Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}Ct("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Ct("ERR_INVALID_ARG_TYPE",function(r,t){return`The "${r}" argument must be of type number. Received type ${typeof t}`},TypeError);Ct("ERR_OUT_OF_RANGE",function(r,t,e){let n=`The value of "${r}" is out of range.`,i=e;return Number.isInteger(e)&&Math.abs(e)>2**32?i=Ae(String(e)):typeof e=="bigint"&&(i=String(e),(e>BigInt(2)**BigInt(32)||e<-(BigInt(2)**BigInt(32)))&&(i=Ae(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n},RangeError);function Ae(r){let t="",e=r.length,n=r[0]==="-"?1:0;for(;e>=n+4;e-=3)t=`_${r.slice(e-3,e)}${t}`;return`${r.slice(0,e)}${t}`}function fn(r,t,e){j(t,"offset"),(r[t]===void 0||r[t+e]===void 0)&&V(t,r.length-(e+1))}function be(r,t,e,n,i,o){if(r>e||r<t){let s=typeof t=="bigint"?"n":"",a;throw o>3?t===0||t===BigInt(0)?a=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:a=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:a=`>= ${t}${s} and <= ${e}${s}`,new W.ERR_OUT_OF_RANGE("value",a,r)}fn(n,i,o)}function j(r,t){if(typeof r!="number")throw new W.ERR_INVALID_ARG_TYPE(t,"number",r)}function V(r,t,e){throw Math.floor(r)!==r?(j(r,e),new W.ERR_OUT_OF_RANGE(e||"offset","an integer",r)):t<0?new W.ERR_BUFFER_OUT_OF_BOUNDS:new W.ERR_OUT_OF_RANGE(e||"offset",`>= ${e?1:0} and <= ${t}`,r)}var cn=/[^+/0-9A-Za-z-_]/g;function hn(r){if(r=r.split("=")[0],r=r.trim().replace(cn,""),r.length<2)return"";for(;r.length%4!=0;)r=r+"=";return r}function Ft(r,t){t=t||Infinity;let e,n=r.length,i=null,o=[];for(let s=0;s<n;++s){if(e=r.charCodeAt(s),e>55295&&e<57344){if(!i){if(e>56319){(t-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(t-=3)>-1&&o.push(239,191,189),i=e;continue}e=(i-55296<<10|e-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((t-=1)<0)break;o.push(e)}else if(e<2048){if((t-=2)<0)break;o.push(e>>6|192,e&63|128)}else if(e<65536){if((t-=3)<0)break;o.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((t-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return o}function tn(r){let t=[];for(let e=0;e<r.length;++e)t.push(r.charCodeAt(e)&255);return t}function nn(r,t){let e,n,i,o=[];for(let s=0;s<r.length&&!((t-=2)<0);++s)e=r.charCodeAt(s),n=e>>8,i=e%256,o.push(i),o.push(n);return o}function we(r){return gt.toByteArray(hn(r))}function tt(r,t,e,n){let i;for(i=0;i<n&&!(i+e>=t.length||i>=r.length);++i)t[i+e]=r[i];return i}function A(r,t){return r instanceof t||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===t.name}function It(r){return r!==r}var un=function(){let r="0123456789abcdef",t=new Array(256);for(let e=0;e<16;++e){let n=e*16;for(let i=0;i<16;++i)t[n+i]=r[e]+r[i]}return t}();function U(r){return typeof BigInt=="undefined"?an:r}function an(){throw new Error("BigInt not supported")}});var et=E((Zn,Re)=>{"use strict";var{Buffer:C}=Se(),Te=Symbol.for("BufferList");function g(r){if(!(this instanceof g))return new g(r);g._init.call(this,r)}g._init=function(t){Object.defineProperty(this,Te,{value:!0}),this._bufs=[],this.length=0,t&&this.append(t)};g.prototype._new=function(t){return new g(t)};g.prototype._offset=function(t){if(t===0)return[0,0];let e=0;for(let n=0;n<this._bufs.length;n++){let i=e+this._bufs[n].length;if(t<i||n===this._bufs.length-1)return[n,t-e];e=i}};g.prototype._reverseOffset=function(r){let t=r[0],e=r[1];for(let n=0;n<t;n++)e+=this._bufs[n].length;return e};g.prototype.get=function(t){if(t>this.length||t<0)return;let e=this._offset(t);return this._bufs[e[0]][e[1]]};g.prototype.slice=function(t,e){return typeof t=="number"&&t<0&&(t+=this.length),typeof e=="number"&&e<0&&(e+=this.length),this.copy(null,0,t,e)};g.prototype.copy=function(t,e,n,i){if((typeof n!="number"||n<0)&&(n=0),(typeof i!="number"||i>this.length)&&(i=this.length),n>=this.length||i<=0)return t||C.alloc(0);let o=!!t,s=this._offset(n),a=i-n,h=a,l=o&&e||0,f=s[1];if(n===0&&i===this.length){if(!o)return this._bufs.length===1?this._bufs[0]:C.concat(this._bufs,this.length);for(let c=0;c<this._bufs.length;c++)this._bufs[c].copy(t,l),l+=this._bufs[c].length;return t}if(h<=this._bufs[s[0]].length-f)return o?this._bufs[s[0]].copy(t,e,f,f+h):this._bufs[s[0]].slice(f,f+h);o||(t=C.allocUnsafe(a));for(let c=s[0];c<this._bufs.length;c++){let d=this._bufs[c].length-f;if(h>d)this._bufs[c].copy(t,l,f),l+=d;else{this._bufs[c].copy(t,l,f,f+h),l+=d;break}h-=d,f&&(f=0)}return t.length>l?t.slice(0,l):t};g.prototype.shallowSlice=function(t,e){if(t=t||0,e=typeof e!="number"?this.length:e,t<0&&(t+=this.length),e<0&&(e+=this.length),t===e)return this._new();let n=this._offset(t),i=this._offset(e),o=this._bufs.slice(n[0],i[0]+1);return i[1]===0?o.pop():o[o.length-1]=o[o.length-1].slice(0,i[1]),n[1]!==0&&(o[0]=o[0].slice(n[1])),this._new(o)};g.prototype.toString=function(t,e,n){return this.slice(e,n).toString(t)};g.prototype.consume=function(t){if(t=Math.trunc(t),Number.isNaN(t)||t<=0)return this;for(;this._bufs.length;)if(t>=this._bufs[0].length)t-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(t),this.length-=t;break}return this};g.prototype.duplicate=function(){let t=this._new();for(let e=0;e<this._bufs.length;e++)t.append(this._bufs[e]);return t};g.prototype.append=function(t){if(t==null)return this;if(t.buffer)this._appendBuffer(C.from(t.buffer,t.byteOffset,t.byteLength));else if(Array.isArray(t))for(let e=0;e<t.length;e++)this.append(t[e]);else if(this._isBufferList(t))for(let e=0;e<t._bufs.length;e++)this.append(t._bufs[e]);else typeof t=="number"&&(t=t.toString()),this._appendBuffer(C.from(t));return this};g.prototype._appendBuffer=function(t){this._bufs.push(t),this.length+=t.length};g.prototype.indexOf=function(r,t,e){if(e===void 0&&typeof t=="string"&&(e=t,t=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=C.from([r]):typeof r=="string"?r=C.from(r,e):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=C.from(r.buffer,r.byteOffset,r.byteLength):C.isBuffer(r)||(r=C.from(r)),t=Number(t||0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),r.length===0)return t>this.length?this.length:t;let n=this._offset(t),i=n[0],o=n[1];for(;i<this._bufs.length;i++){let s=this._bufs[i];for(;o<s.length;)if(s.length-o>=r.length){let h=s.indexOf(r,o);if(h!==-1)return this._reverseOffset([i,h]);o=s.length-r.length+1}else{let h=this._reverseOffset([i,o]);if(this._match(h,r))return h;o++}o=0}return-1};g.prototype._match=function(r,t){if(this.length-r<t.length)return!1;for(let e=0;e<t.length;e++)if(this.get(r+e)!==t[e])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let t in r)(function(e){r[e]===null?g.prototype[e]=function(n,i){return this.slice(n,n+i)[e](0,i)}:g.prototype[e]=function(n=0){return this.slice(n,n+r[e])[e](0)}})(t)})();g.prototype._isBufferList=function(t){return t instanceof g||g.isBufferList(t)};g.isBufferList=function(t){return t!=null&&t[Te]};Re.exports=g});var Ne=E((Jn,Ue)=>{"use strict";var rt=yt(),Me=et(),_t=10*1024,Le=class{constructor(){this._pool=new Uint8Array(_t),this._poolOffset=0}write(t){let e=this._pool,n=this._poolOffset;rt.encode(t.id<<3|t.type,e,n),n+=rt.encode.bytes,rt.encode(t.data?t.data.length:0,e,n),n+=rt.encode.bytes;let i=e.subarray(this._poolOffset,n);return _t-n<100?(this._pool=new Uint8Array(_t),this._poolOffset=0):this._poolOffset=n,t.data?[i,t.data]:i}},Oe=new Le;Ue.exports=r=>async function*(){for await(let e of r)Array.isArray(e)?yield new Me(e.map(n=>Oe.write(n))):yield new Me(Oe.write(e))}()});var De=E((Kn,ke)=>{"use strict";var nt=yt(),ln=et();ke.exports=r=>async function*(){let e=new Pe;for await(let n of r){let i=e.write(n);i.length&&(yield i)}}();var Pe=class{constructor(){this._buffer=new ln,this._bufferProxy=new Proxy({},{get:(t,e)=>e[0]==="l"?this._buffer[e]:this._buffer.get(parseInt(e))}),this._headerInfo=null}write(t){if(!t||!t.length)return[];this._buffer.append(t);let e=[];for(;;){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch(h){break}let{id:n,type:i,length:o,offset:s}=this._headerInfo;if(this._buffer.length-s<o)break;e.push({id:n,type:i,data:this._buffer.shallowSlice(s,s+o)}),this._buffer.consume(s+o),this._headerInfo=null}return e}_decodeHeader(t){let e=nt.decode(t),n=nt.decode.bytes,i=nt.decode(t,n);return n+=nt.decode.bytes,{id:e>>3,type:e&7,offset:n,length:i}}}});var qe=E(At=>{"use strict";At.encode=Ne();At.decode=De()});var Rt=E((ti,St)=>{"use strict";var $e=1<<20;St.exports=r=>{r=r||$e;let t=e=>{if(e.data&&e.data.length>r)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return e=>async function*(){for await(let i of e)Array.isArray(i)?i.forEach(t):t(i),yield i}()};St.exports.MAX_MSG_SIZE=$e});var Tt=E(X=>{"use strict";var R=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});X.MessageTypes=R;X.InitiatorMessageTypes=Object.freeze({NEW_STREAM:R.NEW_STREAM,MESSAGE:R.MESSAGE_INITIATOR,CLOSE:R.CLOSE_INITIATOR,RESET:R.RESET_INITIATOR});X.ReceiverMessageTypes=Object.freeze({MESSAGE:R.MESSAGE_RECEIVER,CLOSE:R.CLOSE_RECEIVER,RESET:R.RESET_RECEIVER});X.MessageTypeNames=Object.freeze(Object.entries(R).reduce((r,t)=>(r[t[1]]=t[0],r),{}))});var ze=E((ri,it)=>{"use strict";var{AbortController:Ge,AbortSignal:pn}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;it.exports=Ge;it.exports.AbortSignal=pn;it.exports.default=Ge});var Ve=E((ni,je)=>{"use strict";function We(r,t){for(let e in t)Object.defineProperty(r,e,{value:t[e],enumerable:!0,configurable:!0});return r}function dn(r,t,e){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");e||(e={}),typeof t=="object"&&(e=t,t=""),t&&(e.code=t);try{return We(r,e)}catch(n){e.message=r.message,e.stack=r.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(r)),We(new i,e)}}je.exports=dn});var Ye=E((ii,Xe)=>{"use strict";var yn=lt(),ve=ze(),v=ct()("libp2p:mplex:stream"),wn=ft(),He=et(),En=Ve(),{MAX_MSG_SIZE:gn}=Rt(),{InitiatorMessageTypes:xn,ReceiverMessageTypes:mn}=Tt(),Ut="ERR_MPLEX_STREAM_RESET",bn="ERR_MPLEX_STREAM_ABORT";Xe.exports=({id:r,name:t,send:e,onEnd:n=()=>{},type:i="initiator",maxMsgSize:o=gn})=>{let s=new ve,a=new ve,h=i==="initiator"?xn:mn,l=i==="initiator"?`i${r}`:`r${r}`;t=String(t??r);let f=!1,c=!1,d,w=y=>{f||(f=!0,v("%s stream %s source end",i,t,y),y&&!d&&(d=y),c&&(x.timeline.close=Date.now(),n(d)))},p=y=>{c||(c=!0,v("%s stream %s sink end",i,t,y),y&&!d&&(d=y),f&&(x.timeline.close=Date.now(),n(d)))},x={close:()=>x.source.end(),abort:y=>{v("%s stream %s abort",i,t,y),x.source.end(y),s.abort(),p(y)},reset:()=>{let y=En(new Error("stream reset"),Ut);a.abort(),x.source.end(y),p(y)},sink:async y=>{y=yn(y,[{signal:s.signal,options:{abortMessage:"stream aborted",abortCode:bn}},{signal:a.signal,options:{abortMessage:"stream reset",abortCode:Ut}}]),i==="initiator"&&e({id:r,type:h.NEW_STREAM,data:t});try{for await(let b of y)for(;b.length;){if(b.length<=o){e({id:r,type:h.MESSAGE,data:b});break}b=He.isBufferList(b)?b:new He(b),e({id:r,type:h.MESSAGE,data:b.shallowSlice(0,o)}),b.consume(o)}}catch(b){return b.code===Ut?v("%s stream %s reset",i,t):(v("%s stream %s error",i,t,b),e({id:r,type:h.RESET})),x.source.end(b),p(b)}e({id:r,type:h.CLOSE}),p()},source:wn(w),timeline:{open:Date.now(),close:null},id:l};return x}});var Qe=E((oi,Ze)=>{"use strict";var Bn=kt(),In=ft(),T=ct()("libp2p:mplex"),Fn=lt(),Je=qe(),Cn=Rt(),{MessageTypes:N,MessageTypeNames:Ke}=Tt(),_n=Ye(),Mt=class{constructor(t){t=t||{},t=typeof t=="function"?{onStream:t}:t,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=t,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=t.onStream,this.onStreamEnd=t.onStreamEnd}get streams(){let t=[];return this._streams.initiators.forEach(e=>{t.push(e)}),this._streams.receivers.forEach(e=>{t.push(e)}),t}newStream(t){let e=this._streamId++;t=t==null?e.toString():String(t);let n=this._streams.initiators;return this._newStream({id:e,name:t,type:"initiator",registry:n})}_newReceiverStream({id:t,name:e}){let n=this._streams.receivers;return this._newStream({id:t,name:e,type:"receiver",registry:n})}_newStream({id:t,name:e,type:n,registry:i}){if(i.has(t))throw new Error(`${n} stream ${t} already exists!`);T("new %s stream %s %s",n,t,e);let a=_n({id:t,name:e,send:h=>(T.enabled&&T("%s stream %s %s send",n,t,e,{...h,type:Ke[h.type],data:h.data&&h.data.slice()}),this.source.push(h)),type:n,onEnd:()=>{T("%s stream %s %s ended",n,t,e),i.delete(t),this.onStreamEnd&&this.onStreamEnd(a)},maxMsgSize:this._options.maxMsgSize});return i.set(t,a),a}_createSink(){return async t=>{this._options.signal&&(t=Fn(t,this._options.signal));try{await Bn(t,Je.decode,Cn(this._options.maxMsgSize),async e=>{for await(let n of e)for(let i of n)this._handleIncoming(i)})}catch(e){return T("error in sink",e),this.source.end(e)}this.source.end()}}_createSource(){let e=In({onEnd:n=>{let{initiators:i,receivers:o}=this._streams;for(let s of i.values())s.abort(n);for(let s of o.values())s.abort(n)},writev:!0});return Object.assign(Je.encode(e),{push:e.push,end:e.end,return:e.return})}_handleIncoming({id:t,type:e,data:n}){if(T.enabled&&T("incoming message",{id:t,type:Ke[e],data:n.slice()}),e===N.NEW_STREAM&&this.onStream){let s=this._newReceiverStream({id:t,name:n.toString()});return this.onStream(s)}let o=(e&1?this._streams.initiators:this._streams.receivers).get(t);if(!o)return T("missing stream %s",t);switch(e){case N.MESSAGE_INITIATOR:case N.MESSAGE_RECEIVER:o.source.push(n);break;case N.CLOSE_INITIATOR:case N.CLOSE_RECEIVER:o.close();break;case N.RESET_INITIATOR:case N.RESET_RECEIVER:o.reset();break;default:T("unknown message type %s",e)}}};Mt.multicodec="/mplex/6.7.0";Ze.exports=Mt});var An=E((si,tr)=>{"use strict";tr.exports=Qe()});return An();})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
return Libp2pMplex}));
